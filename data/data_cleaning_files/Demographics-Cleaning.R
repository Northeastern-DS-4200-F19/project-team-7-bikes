# Read in the individual .csv files of data
## 2015
jan15dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201501.csv")
feb15dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201502.csv")
mar15dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201503.csv")
apr15dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201504.csv")
may15dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201505.csv")
jun15dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201506.csv")
jul15dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201507.csv")
aug15dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201508.csv")
sep15dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201509.csv")
oct15dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201510.csv")
nov15dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201511.csv")
dec15dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201512.csv")

## 2016
jan16dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201601.csv")
feb16dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201602.csv")
mar16dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201603.csv")
apr16dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201604.csv")
may16dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201605.csv")
jun16dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201606.csv")
jul16dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201607.csv")
aug16dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201608.csv")
sep16dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201609.csv")
oct16dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201610.csv")
nov16dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201611.csv")
dec16dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201612.csv")

## 2017
jan17dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201701.csv")
feb17dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201702.csv")
mar17dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201703.csv")
apr17dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201704.csv")
may17dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201705.csv")
jun17dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201706.csv")
jul17dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201707.csv")
aug17dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201708.csv")
sep17dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201709.csv")
oct17dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201710.csv")
nov17dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201711.csv")
dec17dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201712.csv")

## 2018
jan18dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201801.csv")
feb18dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201802.csv")
mar18dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201803.csv")
apr18dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201804.csv")
may18dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201805.csv")
jun18dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201806.csv")
jul18dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201807.csv")
aug18dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201808.csv")
sep18dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201809.csv")
oct18dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201810dem.csv")
nov18dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201811dem.csv")
dec18dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201812dem.csv")

## 2019
jan19dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201901dem.csv")
feb19dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201902dem.csv")
mar19dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201903dem.csv")
apr19dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201904dem.csv")
may19dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201905dem.csv")
jun19dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201906dem.csv")
jul19dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201907dem.csv")
aug19dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201908dem.csv")
sep19dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201909dem.csv")
oct19dem = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201910.csv")

# Merge the individual data files into one
all_boston_dem = rbind(jan15dem, feb15dem, mar15dem, apr15dem, may15dem, jun15dem, jul15dem, aug15dem, sep15dem, oct15dem, nov15dem, dec15dem,
                   jan16dem, feb16dem, mar16dem, apr16dem, may16dem, jun16dem, jul16dem, aug16dem, sep16dem, oct16dem, nov16dem, dec16dem,
                   jan17dem, feb17dem, mar17dem, apr17dem, may17dem, jun17dem, jul17dem, aug17dem, sep17dem, oct17dem, nov17dem, dec17dem,
                   jan18dem, feb18dem, mar18dem, apr18dem, may18dem, jun18dem, jul18dem, aug18dem, sep18dem, oct18dem, nov18dem, dec18dem,
                   jan19dem, feb19dem, mar19dem, apr19dem, may19dem, jun19dem, jul19dem, aug19dem, sep19dem, oct19dem)
all_boston_dem$birth.year[all_boston_dem$birth.year == "\\N"] = NA
all_boston_dem$birth.year[is.null(all_boston_dem$birth.year)] = NA
all_boston_dem$birth.year[all_boston_dem$birth.year == "1900" 
                       || all_boston_dem$birth.year == "1917" 
                       || all_boston_dem$birth.year == "1901" 
                       || all_boston_dem$birth.year == "1902" 
                       || all_boston_dem$birth.year == "1886" 
                       || all_boston_dem$birth.year == "1927" 
                       || all_boston_dem$birth.year == "1887" 
                       || all_boston_dem$birth.year == "1929" 
                       || all_boston_dem$birth.year == "1888"] = NA
all_boston_dem$age = 2019 - all_boston_dem$birth.year
all_boston_dem = all_boston_dem[c("bikeid", "usertype", "age", "gender", "starttime")]

install.packages("dplyr")
library(dplyr)

jan15dem$age = 2019 - jan15dem$birth.year
feb15dem$age = 2019 - feb15dem$birth.year
mar15dem$age = 2019 - mar15dem$birth.year
apr15dem$age = 2019 - apr15dem$birth.year
may15dem$age = 2019 - may15dem$birth.year
jun15dem$age = 2019 - jun15dem$birth.year
jul15dem$age = 2019 - jul15dem$birth.year
aug15dem$age = 2019 - aug15dem$birth.year
sep15dem$age = 2019 - sep15dem$birth.year
oct15dem$age = 2019 - oct15dem$birth.year
nov15dem$age = 2019 - nov15dem$birth.year
dec15dem$age = 2019 - dec15dem$birth.year
# 
create_subset = function(x) {
  x[c("bikeid", "usertype", "age", "gender", "yearmonth")];
}

jan15_dem = create_subset(jan15)

## Subscriber/Customer Count
count_sub = function(x) {
  x %>%
    group_by(yearmonth) %>%
    filter(usertype == "Subscriber") %>%
    summarize(subscriber = n());
}

count_cust = function(x) {
  x %>%
    group_by(yearmonth) %>%
    filter(usertype == "Customer") %>%
    summarize(customer = n());
}

subscribers = count_sub(all_boston_dem)
customers = count_cust(all_boston_dem)
users = merge(subscribers, customers, by = "yearmonth")

## Gender Count
count_male = function(x) {
  x %>%
    group_by(yearmonth) %>%
    filter(gender == 1) %>%
    summarize(male = n());
}

count_female = function(x) {
  x %>%
    group_by(yearmonth) %>%
    filter(gender == 2) %>%
    summarize(female = n());
}

count_non_reported = function(x) {
  x %>%
    group_by(yearmonth) %>%
    filter(gender == 0) %>%
    summarize(non_reported = n());
}

male = count_male(all_boston_dem)
female = count_female(all_boston_dem)
non_reported = count_non_reported(all_boston_dem)
gender1 = merge(male, female, by = "yearmonth")
gender = merge(gender1, non_reported, by = "yearmonth")

# Age Count
avg_age = function(x) {
  x %>%
    group_by(yearmonth) %>%
    summarize(age = mean(age));
}

age = avg_age(all_boston_dem)

# Write data frames to .csv files
write.csv(users, 
          "/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/project-team-7-bikes/data/users.csv")
write.csv(gender, 
          "/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/project-team-7-bikes/data/gender.csv")
write.csv(age, 
          "/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/project-team-7-bikes/data/age.csv")