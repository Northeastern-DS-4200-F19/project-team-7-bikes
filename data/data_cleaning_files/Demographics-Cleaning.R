# Read in the individual .csv files of data
## 2015
jan15 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201501.csv")
feb15 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201502.csv")
mar15 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201503.csv")
apr15 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201504.csv")
may15 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201505.csv")
jun15 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201506.csv")
jul15 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201507.csv")
aug15 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201508.csv")
sep15 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201509.csv")
oct15 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201510.csv")
nov15 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201511.csv")
dec15 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201512.csv")

## 2016
jan16 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201601.csv")
feb16 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201602.csv")
mar16 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201603.csv")
apr16 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201604.csv")
may16 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201605.csv")
jun16 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201606.csv")
jul16 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201607.csv")
aug16 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201608.csv")
sep16 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201609.csv")
oct16 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201610.csv")
nov16 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201611.csv")
dec16 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201612.csv")

## 2017
jan17 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201701.csv")
feb17 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201702.csv")
mar17 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201703.csv")
apr17 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201704.csv")
may17 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201705.csv")
jun17 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201706.csv")
jul17 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201707.csv")
aug17 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201708.csv")
sep17 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201709.csv")
oct17 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201710.csv")
nov17 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201711.csv")
dec17 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201712.csv")

## 2018
jan18 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201801.csv")
feb18 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201802.csv")
mar18 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201803.csv")
apr18 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201804.csv")
may18 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201805.csv")
jun18 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201806.csv")
jul18 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201807.csv")
aug18 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201808.csv")
sep18 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201809.csv")
oct18 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201810.csv")
nov18 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201811.csv")
dec18 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201812.csv")

## 2019
jan19 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201901.csv")
feb19 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201902.csv")
mar19 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201903.csv")
apr19 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201904.csv")
may19 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201905.csv")
jun19 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201906.csv")
jul19 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201907.csv")
aug19 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201908.csv")
sep19 = read.csv("/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/Project/BlueBikes Data/201909.csv")

# Merge the individual data files into one
# all_boston = rbind(jan15, feb15, mar15, apr15, may15, jun15, jul15, aug15, sep15, oct15, nov15, dec15,
#                    jan16, feb16, mar16, apr16, may16, jun16, jul16, aug16, sep16, oct16, nov16, dec16,
#                    jan17, feb17, mar17, apr17, may17, jun17, jul17, aug17, sep17, oct17, nov17, dec17,
#                    jan18, feb18, mar18, apr18, may18, jun18, jul18, aug18, sep18, oct18, nov18, dec18,
#                    jan19, feb19, mar19, apr19, may19, jun19, jul19, aug19, sep19)
all_boston = rbind(oct18, nov18, dec18,
                                      jan19, feb19, mar19, apr19, may19, jun19, jul19, aug19, sep19)
all_boston$yearmonth = substr(all_boston$starttime, 1, 7)
all_boston$age = 2019 - all_boston$birth.year
all_boston_dem = all_boston[c("bikeid", "usertype", "age", "gender", "yearmonth")]

install.packages("dplyr")
library(dplyr)

jan15$age = 2019 - jan15$birth.year
feb15$age = 2019 - feb15$birth.year
mar15$age = 2019 - mar15$birth.year
apr15$age = 2019 - apr15$birth.year
may15$age = 2019 - may15$birth.year
jun15$age = 2019 - jun15$birth.year
jul15$age = 2019 - jul15$birth.year
aug15$age = 2019 - aug15$birth.year
sep15$age = 2019 - sep15$birth.year
oct15$age = 2019 - oct15$birth.year
nov15$age = 2019 - nov15$birth.year
dec15$age = 2019 - dec15$birth.year
# 
create_subset = function(x) {
  x[c("bikeid", "usertype", "age", "gender", "yearmonth")];
}

jan15_dem = create_subset(jan15)

## Subscriber/Customer Count
count_sub = function(x) {
  x %>%
    group_by(yearmonth) %>%
    filter(usertype == "Subscriber") %>%
    summarize(subscriber = n());
}

count_cust = function(x) {
  x %>%
    group_by(yearmonth) %>%
    filter(usertype == "Customer") %>%
    summarize(customer = n());
}

subscribers = count_sub(all_boston_dem)
customers = count_cust(all_boston_dem)
users = merge(subscribers, customers, by = "yearmonth")

## Gender Count
count_male = function(x) {
  x %>%
    group_by(yearmonth) %>%
    filter(gender == 1) %>%
    summarize(male = n());
}

count_female = function(x) {
  x %>%
    group_by(yearmonth) %>%
    filter(gender == 2) %>%
    summarize(female = n());
}

count_non_reported = function(x) {
  x %>%
    group_by(yearmonth) %>%
    filter(gender == 0) %>%
    summarize(non_reported = n());
}

male = count_male(all_boston_dem)
female = count_female(all_boston_dem)
non_reported = count_non_reported(all_boston_dem)
gender1 = merge(male, female, by = "yearmonth")
gender = merge(gender1, non_reported, by = "yearmonth")

# Age Count
avg_age = function(x) {
  x %>%
    group_by(yearmonth) %>%
    summarize(age = mean(age));
}

age = avg_age(all_boston_dem)

# Write data frames to .csv files
write.csv(users, 
          "/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/project-team-7-bikes/data/users.csv")
write.csv(gender, 
          "/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/project-team-7-bikes/data/gender.csv")
write.csv(age, 
          "/Users/gauri_dandi/Documents/Northeastern/2019-2020/DS4200/project-team-7-bikes/data/age.csv")